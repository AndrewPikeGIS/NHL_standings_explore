---
title: "NHL standings investigation"
author: "Andrew Pike"
date: "11/17/2021"
output:
    rmdformats::material:
        use_bookdown: false
        highlight: tango
---

```{r load_libraries, echo = FALSE, message= FALSE, warning= FALSE}

library(readr)
library(dplyr)
library(tidyr)
library(stringr)
library(reshape2)
library(kableExtra)
library(reactable)

```

# Load Data

All data was sourced from Hockey-Reference.com

Example -> https://www.hockey-reference.com/leagues/NHL_2021_standings.html

Clean standins table for 2005-2021:

```{r load_tables, echo = FALSE, warning = FALSE, message = FALSE}
standings_2020_21 <- read_csv("data/2020_21_standings.csv")
standings_2019_20 <- read_csv("data/2019_20_standings.csv")
standings_2018_19 <- read_csv("data/2018_19_standings.csv")
standings_2017_18 <- read_csv("data/2017_18_standings.csv")
standings_2016_17 <- read_csv("data/2016_17_standings.csv")
standings_2015_16 <- read_csv("data/2015_16_standings.csv")
standings_2014_15 <- read_csv("data/2014_15_standings.csv")
standings_2013_14 <- read_csv("data/2013_14_standings.csv")
standings_2012_13 <- read_csv("data/2012_13_standings.csv")
standings_2011_12 <- read_csv("data/2011_12_standings.csv")
standings_2010_11 <- read_csv("data/2010_11_standings.csv")
standings_2009_10 <- read_csv("data/2009_10_standings.csv")
standings_2008_09 <- read_csv("data/2008_09_standings.csv")
standings_2007_08 <- read_csv("data/2007_08_standings.csv")
standings_2006_07 <- read_csv("data/2006_07_standings.csv")
standings_2005_06 <- read_csv("data/2005_06_standings.csv")

list_standings <- list(
    standings_2020_21,
    standings_2019_20,
    standings_2018_19,
    standings_2017_18,
    standings_2016_17,
    standings_2015_16,
    standings_2014_15,
    standings_2013_14,
    standings_2012_13,
    standings_2011_12,
    standings_2010_11,
    standings_2009_10,
    standings_2008_09,
    standings_2007_08,
    standings_2006_07,
    standings_2005_06
)

standings_merged <- bind_rows(list_standings, .id = "column_label")

```


```{r clean_data, echo = FALSE, warning = FALSE, message = FALSE}
clean_table <- function(df_in) {
    df_out <- df_in %>%
        separate(Overall, c("wins", "losses", "ot_losses"), "-") %>%
        separate(Shootout, c("so_wins", "so_losses"), "-") %>%
        separate(Overtime, c("ot_wins", "ot_only_losses"), "-") %>%
        mutate(
            ot_wins = as.numeric(ot_wins) + as.numeric(so_wins),
            wins = as.numeric(wins) - ot_wins,
            losses = as.numeric(losses),
            ot_losses = as.numeric(ot_losses),
            total_wins = wins + ot_wins,
            year = case_when(
                column_label == 1 ~ "20_21",
                column_label == 2 ~ "19_20",
                column_label == 3 ~ "18_19",
                column_label == 4 ~ "17_18",
                column_label == 5 ~ "16_17",
                column_label == 6 ~ "15_16",
                column_label == 7 ~ "14_15",
                column_label == 8 ~ "13_14",
                column_label == 9 ~ "12_13",
                column_label == 10 ~ "11_12",
                column_label == 11 ~ "10_11",
                column_label == 12 ~ "09_10",
                column_label == 13 ~ "08_09",
                column_label == 14 ~ "07_08",
                column_label == 15 ~ "06_07",
                column_label == 16 ~ "05_06"
            )
        ) %>%
        select(
            Rk,
            Team,
            wins,
            losses,
            ot_losses,
            ot_wins,
            total_wins,
            year
        )
    return(df_out)
}

clean_standings_merged <- clean_table(standings_merged)

kbl(clean_standings_merged) %>%
    kable_material(
        c("striped",
        "hover",
        "responsive")) %>%
    scroll_box(height = "500px")
```

```{r clean_division_table, echo = FALSE, warning = FALSE, message = FALSE}
#quick division table clean up

div_conf <- read_csv("data/conference_division_alignment.csv")

div_conf_long <- div_conf %>%
    pivot_longer(
        !Team,
        names_to = "div_conf",
        values_to = "group"
    )

div_conf_split <- colsplit(
    div_conf_long$div_conf,
    "_",
    c("group_level", "year")
)

div_conf_long <- cbind(div_conf_long, div_conf_split)

```

# Apply Point Schemas

Three different point schemas are being evaluated. The current two point system employed by the NHL. <br>
2 points for a regulation or OT/shootout win and 1 point for an OT/shootout loss. A three point system <br>
where regulations wins are rewarded, 3 points for regulation win, 2 points for OT/shootout win, 1 point<br>
for an OT/shootout loss. Finally a win/loss system where a single point is awarded for a regulation or <br>
OT/shootout win and no points for any loss.

```{r apply_point_schemas, echo = FALSE, warning = FALSE, message = FALSE}
apply_point_system <- function(df_in) {
    df_out <- df_in %>%
        mutate(
            points_2 = (2 * total_wins) + (1 * ot_losses),
            points_3 = (3 * wins) + (2 * ot_wins) + (1 * ot_losses),
            points_win_loss = total_wins
        )
    return(df_out)
}

merged_standings_w_points <- apply_point_system(clean_standings_merged)

merged_standings_points_div <- merge(
    merged_standings_w_points,
    div_conf_long,
    by = c("Team", "year"),
    all = TRUE)

```

```{r build_20_21_functions, echo = FALSE, warning = FALSE, message = FALSE}

#2020 - 2021 playoff teams were top 4 in each division.

set_2020_2021_playoff_teams <- function(df_in) {

    df_out <- df_in %>%
        drop_na() %>%
        filter(
            year == "20_21",
            group_level == "div"
        ) %>%
        group_by(group) %>%
        mutate(
            div_order_p2 = order(
                order(
                    points_2,
                    total_wins,
                    decreasing = TRUE)),
            div_order_p3 = order(
                order(
                    points_3,
                    wins,
                    decreasing = TRUE)),
            div_order_win_loss = order(
                order(
                    points_win_loss,
                    wins,
                    decreasing = TRUE)),
            playoff_p2 = if_else(div_order_p2 <= 4, "yes", "no"),
            playoff_p3 = if_else(div_order_p3 <= 4, "yes", "no"),
            playoff_win_loss = if_else(div_order_win_loss <= 4, "yes", "no"),
        ) %>%
        ungroup()
    return(df_out)
}

filter_div <- function(df_in, division) {
    df_out <- df_in %>%
        filter(group == division)
    return(df_out)
}

playoff_table_select <- function(df_in,
                                 points_field,
                                 playoff_field,
                                 wins_col = quo(wins),
                                 year_filter = "20_21") {

    df_out <- df_in %>%
        filter(
            year == year_filter &
            group_level == "div"
        ) %>%
        select(
            Team,
            year,
            group,
            wins,
            losses,
            ot_losses,
            ot_wins,
            total_wins,
            !!points_field,
            !!playoff_field) %>%
        arrange(
            group,
            desc(!!points_field),
            desc(!!wins_col)) %>%
        rename(
            "Group" = group,
            "Wins" = wins,
            "Losses" = losses,
            "OT Losses" = ot_losses,
            "OT Wins" = ot_wins,
            "Total Wins" = total_wins,
            "Points Earned" = !!points_field,
            "Playoff Birth Earned" = !!playoff_field
        )
    return(df_out)
}

get_div_team_count <- function(df_in, div_in) {
    df_out <- df_in %>%
        filter(Group == div_in)
    return(length(df_out$Team))
}

playoff_table_kable_20_21 <- function(df_in) {
    central_count <- get_div_team_count(df_in, "Central")
    east_count <- get_div_team_count(df_in, "East")
    north_count <- get_div_team_count(df_in, "North")
    west_count <- get_div_team_count(df_in, "West")

    playoff_yes <- which(df_in[["Playoff Birth Earned"]] == "yes")

    df_in %>%
        kable() %>%
        row_spec(playoff_yes, bold = TRUE) %>%
        kable_styling(
            bootstrap_options = c(
                "striped",
                "hover",
                "responsive"),
                fixed_thead = T) %>%
        pack_rows(
            index = c(
                "Central" = central_count,
                "East" = east_count,
                "North" = north_count,
                "West" = west_count
                ))
}

find_playoff_changes <- function(df_in) {
    df_out <- df_in %>%
        filter(
            playoff_p2 != playoff_p3 |
            playoff_p2 != playoff_win_loss |
            playoff_win_loss != playoff_p3
        )

    return(df_out)
}

discrepancies_kable <- function(
    discrepancies_df,
    year_in = "20_21",
    group_in = "div") {

    discrepancies_df %>%
        filter(
            year == year_in &
            group_level == group_in
        ) %>%
        select(
            Team,
            group,
            wins,
            losses,
            ot_losses,
            ot_wins,
            total_wins,
            points_2,
            points_3,
            points_win_loss,
            playoff_p2,
            playoff_p3,
            playoff_win_loss
        ) %>%
        rename(
            Division = group,
            Wins = wins,
            Losses = losses,
            "OT Losses" = ot_losses,
            "OT Wins" = ot_wins,
            "Total Wins" = total_wins,
            "2 Point System Point Total" = points_2,
            "3 Point System Point Total" = points_3,
            "Win/Loss Point System Point Total" = points_win_loss,
            "Playoff Birth 2 Point System" = playoff_p2,
            "Playoff Birth 3 Point System" = playoff_p3,
            "Playoff Birth Win/Loss Point System" = playoff_win_loss
        ) %>%
        kable() %>%
        kable_styling(
            bootstrap_options = c(
                "striped",
                "hover",
                "responsive"),
            fixed_thead = T) %>%
        scroll_box(width = "1000px")
}

standings_20_21 <- set_2020_2021_playoff_teams(
    merged_standings_points_div
)
```


# 2020-2021 Playoff Standings

The 2020-2021 playoff seeding was changed due to the COVID-19 pandemic. <br>
Teams were re-aligned into four conferences to satisfy the Candian/US border closure with all Candian teams in a new "North" division. <br>
The top four teams in each of the new divisions earned a playoff birth.

## 2 Point System (current NHL system)
**1 point for OT loss, 2 points for a regulation or OT win**

```{r, echo = FALSE, warning = FALSE, message = FALSE}

standings_20_21 %>%
    playoff_table_select(
        quo(points_2),
        quo(playoff_p2),
        quo(total_wins)) %>%
    playoff_table_kable_20_21()

```

## 3 Point System
**1 point for OT loss, 2 point for OT win, 3 points for regulation win**

```{r, echo = FALSE, warning = FALSE, message = FALSE}

standings_20_21 %>%
    playoff_table_select(
        quo(points_3),
        quo(playoff_p3)) %>%
    playoff_table_kable_20_21()

```


## Win/Loss Point System
**1 point for regulation or OT win, 0 points for regulation or OT loss**

```{r, echo = FALSE, warning = FALSE, message = FALSE}
standings_20_21 %>%
    playoff_table_select(
        quo(points_win_loss),
        quo(playoff_win_loss)) %>%
    playoff_table_kable_20_21()
```

## Discrepancies between the systems/ Do different point systems alter playoff teams?


```{r, echo = FALSE, warning = FALSE, message = FALSE}
discrepancies_df_20 <- find_playoff_changes(standings_20_21) %>%
    filter(group_level == "div")

discrepancies_df_20 %>%
    discrepancies_kable()

```

# 2019-2020 Playoff Standings

The 2019-2020 season was shortened because of the COVID-19 pandemic.<br>
When play resumed, the top 24 teams by point percentage in each conference were seeded into the playoff play-in round. <br>
For this exercise the focus will be on which teams earned a birth into the play-in round.

```{r, echo = FALSE, warning = FALSE, message = FALSE}
set_2019_2020_playoff_teams <- function(df_in) {

    df_out <- df_in %>%
        drop_na() %>%
        filter(
            year == "19_20",
            group_level == "conf"
        ) %>%
        mutate(
            point_percent_2 = points_2 /
            ((total_wins + losses + ot_losses) * 2),
            point_percent_3 = points_3 /
            ((total_wins + losses + ot_losses) * 3),
            point_percent_wl = points_win_loss /
            (total_wins + losses + ot_losses)      # nolint
        ) %>%
        group_by(group) %>%
        mutate(
            div_order_pp2 = order(
                order(
                    point_percent_2,
                    total_wins,
                    decreasing = TRUE)),
            div_order_pp3 = order(
                order(
                    point_percent_3,
                    wins,
                    decreasing = TRUE)),
            div_order_ppwl = order(
                order(
                    point_percent_wl,
                    wins,
                    decreasing = TRUE)),
            playoff_pp2 = if_else(div_order_pp2 <= 12, "yes", "no"),
            playoff_pp3 = if_else(div_order_pp3 <= 12, "yes", "no"),
            playoff_ppwl = if_else(div_order_ppwl <= 12, "yes", "no"),
        ) %>%
        ungroup()
    return(df_out)
}

playoff_table_select_19_20 <- function(df_in,
                                       points_field,
                                       pp_field,
                                       playoff_field,
                                       year_filter = "20_21",
                                       wins_col) {

    df_out <- df_in %>%
        select(
            Team,
            year,
            group,
            wins,
            losses,
            ot_losses,
            ot_wins,
            total_wins,
            !!points_field,
            !!pp_field,
            !!playoff_field) %>%
        arrange(
            group,
            desc(!!pp_field),
            desc(!!wins_col)) %>%
        rename(
            "Group" = group,
            "Wins" = wins,
            "Losses" = losses,
            "OT Losses" = ot_losses,
            "OT Wins" = ot_wins,
            "Total Wins" = total_wins,
            "Points Earned" = !!points_field,
            "Points Percentage" = !!pp_field,
            "Playoff Birth Earned" = !!playoff_field
        )
    return(df_out)
}

playoff_table_kable_19_20 <- function(df_in) {
    east_count <- get_div_team_count(df_in, "East")
    west_count <- get_div_team_count(df_in, "West")

    playoff_yes <- which(df_in[["Playoff Birth Earned"]] == "yes")

    df_in %>%
        kable() %>%
        row_spec(playoff_yes, bold = TRUE) %>%
        kable_styling(
            bootstrap_options = c(
                "striped",
                "hover",
                "responsive"),
                fixed_thead = T) %>%
        pack_rows(
            index = c(
                "East" = east_count,
                "West" = west_count
                ))
}

find_playoff_changes_19_20 <- function(df_in) {
    df_out <- df_in %>%
        filter(
            playoff_pp2 != playoff_pp3 |
            playoff_pp2 != playoff_ppwl |
            playoff_ppwl != playoff_pp3
        )

    return(df_out)
}

discrepancies_kable_19_20 <- function(discrepancies_df) {
    discrepancies_df %>%
        filter(
            group_level == "conf"
        ) %>%
        select(
            Team,
            group,
            wins,
            losses,
            ot_losses,
            ot_wins,
            total_wins,
            points_2,
            point_percent_2,
            points_3,
            point_percent_3,
            points_win_loss,
            point_percent_wl,
            playoff_pp2,
            playoff_pp3,
            playoff_ppwl
        ) %>%
        rename(
            Conference = group,
            Wins = wins,
            Losses = losses,
            "OT Losses" = ot_losses,
            "OT Wins" = ot_wins,
            "Total Wins" = total_wins,
            "2 Point System Point Total" = points_2,
            "2 Point System Point %" = point_percent_2,
            "3 Point System Point Total" = points_3,
            "3 Point System Point %" = point_percent_3,
            "Win/Loss Point System Point Total" = points_win_loss,
            "Win/Loss Point System Point %" = point_percent_wl,
            "Playoff Birth 2 Point System" = playoff_pp2,
            "Playoff Birth 3 Point System" = playoff_pp3,
            "Playoff Birth Win/Loss Point System" = playoff_ppwl
        ) %>%
        kable() %>%
        kable_styling(
            bootstrap_options = c(
                "striped",
                "hover",
                "responsive"),
            fixed_thead = T) %>%
        scroll_box(width = "1000px")
}

standings_19_20 <- set_2019_2020_playoff_teams(merged_standings_points_div)

```

## 2 Point System (current NHL system)
**1 point for OT loss, 2 points for a regulation or OT win**

```{r, echo = FALSE, warning = FALSE, message = FALSE}
standings_19_20 %>%
    playoff_table_select_19_20(
        quo(points_2),
        quo(point_percent_2),
        quo(playoff_pp2),
        quo(total_wins)) %>%
    playoff_table_kable_19_20()

```

## 3 Point System
**1 point for OT loss, 2 point for OT win, 3 points for regulation win**

```{r, echo = FALSE, warning = FALSE, message = FALSE}

standings_19_20 %>%
    playoff_table_select_19_20(
        quo(points_3),
        quo(point_percent_3),
        quo(playoff_pp3),
        quo(wins)) %>%
    playoff_table_kable_19_20()

```


## Win/Loss Point System
**1 point for regulation or OT win, 0 points for regulation or OT loss**

```{r, echo = FALSE, warning = FALSE, message = FALSE}
standings_19_20 %>%
    playoff_table_select_19_20(
        quo(points_win_loss),
        quo(point_percent_wl),
        quo(playoff_ppwl),
        quo(wins)) %>%
    playoff_table_kable_19_20()
```


## Discrepancies between the systems/ Do different point systems alter playoff teams?

```{r, echo = FALSE, warning = FALSE, message = FALSE}
discrepancies_df_19 <- find_playoff_changes_19_20(standings_19_20)

discrepancies_df_19 %>%
    discrepancies_kable_19_20()

```


# 2019-2014 Playoff Standings

Starting in the 2013-2014 season, a four division alignment was introduced. <br>
The top three teams in each division earned a playoff birth with the remaining four slots <br>
going to the top two remaining teams in each conference.

```{r build_14_19_functions, echo = FALSE, warning = FALSE, message = FALSE}
#build function for playoff seeding 2014 - 2019
#top three in each division then two wildcards
set_2014_2019_div_seeding <- function(df_in) {
    div_winners_out <- df_in %>%
        filter(
            group_level == "div" &
            (year == "13_14" |
            year == "14_15" |
            year == "15_16" |
            year == "16_17" |
            year == "17_18" |
            year == "18_19")
        ) %>%
        drop_na() %>%
        group_by(
            group,
            year) %>%
        mutate(
            div_order_p2 = order(
                order(
                    points_2,
                    total_wins,
                    decreasing = TRUE)),
            div_order_p3 = order(
                order(
                    points_3,
                    wins,
                    decreasing = TRUE)),
            div_order_win_loss = order(
                order(
                    points_win_loss,
                    wins,
                    decreasing = TRUE)),
            playoff_p2 = if_else(div_order_p2 <= 3, "yes", "no"),
            playoff_p3 = if_else(div_order_p3 <= 3, "yes", "no"),
            playoff_win_loss = if_else(div_order_win_loss <= 3, "yes", "no"),
        ) %>%
        ungroup()
    return(div_winners_out)
}

set_2014_2019_conf_seeding <- function(df_in,
                                       filter_col,
                                       points_col,
                                       wins_col) {
    div_winners_out <- df_in %>%
        filter(
            group_level == "conf" &
            !!filter_col == "no" &
            (year == "13_14" |
            year == "14_15" |
            year == "15_16" |
            year == "16_17" |
            year == "17_18" |
            year == "18_19")
        ) %>%
        drop_na() %>%
        group_by(
            group,
            year
        ) %>%
        mutate(
            conf_order = order(
                order(
                    !!points_col,
                    !!wins_col,
                    decreasing = TRUE)),
            playoff_col = if_else(conf_order <= 2, "yes", "no"),
        ) %>%
        ungroup()
    return(div_winners_out)
}


div_playoff_2014_19 <- set_2014_2019_div_seeding(merged_standings_points_div)

standings_2014_19_w_div_po <- merge(
    x = merged_standings_points_div,
    y = div_playoff_2014_19[, c(
        "Team",
        "year",
        "playoff_p2",
        "playoff_p3",
        "playoff_win_loss")],
    by = c("Team", "year"),
    all.x = TRUE)
#build function for playoff seeding 2019 - 2020


conf_p2_playoff_14_19 <- set_2014_2019_conf_seeding(
    standings_2014_19_w_div_po,
    quo(playoff_p2),
    quo(points_2),
    quo(total_wins)
)

conf_p3_playoff_14_19 <- set_2014_2019_conf_seeding(
    standings_2014_19_w_div_po,
    quo(playoff_p3),
    quo(points_3),
    quo(wins)
)

conf_wl_playoff_14_19 <- set_2014_2019_conf_seeding(
    standings_2014_19_w_div_po,
    quo(playoff_win_loss),
    quo(points_win_loss),
    quo(wins)
)

div_p2_playoff_14_19 <- div_playoff_2014_19 %>%
    filter(playoff_p2 == "yes") %>%
    select(
        Team,
        year,
        playoff_p2
    )

div_p3_playoff_14_19 <- div_playoff_2014_19 %>%
    filter(playoff_p3 == "yes") %>%
    select(
        Team,
        year,
        playoff_p3
    )

div_wl_playoff_14_19 <- div_playoff_2014_19 %>%
    filter(playoff_win_loss == "yes") %>%
    select(
        Team,
        year,
        playoff_win_loss
    )

conf_p2_playoff_14_19 <- conf_p2_playoff_14_19 %>%
    select(
        Team,
        year,
        playoff_col
    ) %>%
    rename(
        playoff_p2 = playoff_col
    )

conf_p3_playoff_14_19 <- conf_p3_playoff_14_19 %>%
    select(
        Team,
        year,
        playoff_col
    ) %>%
    rename(
        playoff_p3 = playoff_col
    )

conf_wl_playoff_14_19 <- conf_wl_playoff_14_19 %>%
    select(
        Team,
        year,
        playoff_col
    ) %>%
    rename(
        playoff_win_loss = playoff_col
    )

wild_card_p2_14_19 <- rbind(div_p2_playoff_14_19, conf_p2_playoff_14_19)
wild_card_p3_14_19 <- rbind(div_p3_playoff_14_19, conf_p3_playoff_14_19)
wild_card_wl_14_19 <- rbind(div_wl_playoff_14_19, conf_wl_playoff_14_19)

wild_card_14_19 <- merge(merged_standings_points_div, wild_card_p2_14_19, by = c("Team", "year"))
wild_card_14_19 <- merge(wild_card_14_19, wild_card_p3_14_19, by = c("Team", "year"))
wild_card_14_19 <- merge(wild_card_14_19, wild_card_wl_14_19, by = c("Team", "year"))

playoff_table_kable_14_19 <- function(df_in) {
    pacific_count <- get_div_team_count(df_in, "Pacific")
    atlantic_count <- get_div_team_count(df_in, "Atlantic")
    metropolitan_count <- get_div_team_count(df_in, "Metropolitan")
    central_count <- get_div_team_count(df_in, "Central")

    playoff_yes <- which(df_in[["Playoff Birth Earned"]] == "yes")

    df_in %>%
        kable() %>%
        row_spec(playoff_yes, bold = TRUE) %>%
        kable_styling(
            bootstrap_options = c(
                "striped",
                "hover",
                "responsive"),
                fixed_thead = T) %>%
        pack_rows(
            index = c(
                "Atlantic" = atlantic_count,
                "Central" = central_count,
                "Metropolitan" = metropolitan_count,
                "Pacific" = pacific_count
                ))
}

```

# 2018-2019 Playoff Standings

## 2 Point System (current NHL system)
**1 point for OT loss, 2 points for a regulation or OT win**

```{r, echo = FALSE, warning = FALSE, message = FALSE}
wild_card_14_19 %>%
    playoff_table_select(
        quo(points_2),
        quo(playoff_p2),
        quo(total_wins),
        year_filter = "18_19") %>%
    playoff_table_kable_14_19()

```

## 3 Point System
**1 point for OT loss, 2 point for OT win, 3 points for regulation win**

```{r, echo = FALSE, warning = FALSE, message = FALSE}

wild_card_14_19 %>%
    playoff_table_select(
        quo(points_3),
        quo(playoff_p3),
        year_filter = "18_19") %>%
    playoff_table_kable_14_19()

```


## Win/Loss Point System
**1 point for regulation or OT win, 0 points for regulation or OT loss**

```{r, echo = FALSE, warning = FALSE, message = FALSE}
wild_card_14_19 %>%
    playoff_table_select(
        quo(points_win_loss),
        quo(playoff_win_loss),
        year_filter = "18_19") %>%
    playoff_table_kable_14_19()
```


## Discrepancies between the systems/ Do different point systems alter playoff teams?

```{r, echo = FALSE, warning = FALSE, message = FALSE}
discrepancies_df_14 <- find_playoff_changes(wild_card_14_19) %>%
    filter(group_level == "div")

discrepancies_df_14 %>%
    discrepancies_kable(year_in = "18_19", group_in = "div")

```


# 2017-2018 Playoff Standings

## 2 Point System (current NHL system)
**1 point for OT loss, 2 points for a regulation or OT win**

```{r, echo = FALSE, warning = FALSE, message = FALSE}
wild_card_14_19 %>%
    playoff_table_select(
        quo(points_2),
        quo(playoff_p2),
        quo(total_wins),
        year_filter = "17_18") %>%
    playoff_table_kable_14_19()

```

## 3 Point System
**1 point for OT loss, 2 point for OT win, 3 points for regulation win**

```{r, echo = FALSE, warning = FALSE, message = FALSE}

wild_card_14_19 %>%
    playoff_table_select(
        quo(points_3),
        quo(playoff_p3),
        year_filter = "17_18") %>%
    playoff_table_kable_14_19()

```


## Win/Loss Point System
**1 point for regulation or OT win, 0 points for regulation or OT loss**

```{r, echo = FALSE, warning = FALSE, message = FALSE}
wild_card_14_19 %>%
    playoff_table_select(
        quo(points_win_loss),
        quo(playoff_win_loss),
        year_filter = "17_18") %>%
    playoff_table_kable_14_19()
```


## Discrepancies between the systems/ Do different point systems alter playoff teams?

```{r, echo = FALSE, warning = FALSE, message = FALSE}
discrepancies_df_14 %>%
    discrepancies_kable(year_in = "17_18", group_in = "div")

```


# 2016-2017 Playoff Standings

## 2 Point System (current NHL system)
**1 point for OT loss, 2 points for a regulation or OT win**

```{r, echo = FALSE, warning = FALSE, message = FALSE}
wild_card_14_19 %>%
    playoff_table_select(
        quo(points_2),
        quo(playoff_p2),
        quo(total_wins),
        year_filter = "16_17") %>%
    playoff_table_kable_14_19()

```

## 3 Point System
**1 point for OT loss, 2 point for OT win, 3 points for regulation win**

```{r, echo = FALSE, warning = FALSE, message = FALSE}

wild_card_14_19 %>%
    playoff_table_select(
        quo(points_3),
        quo(playoff_p3),
        year_filter = "16_17") %>%
    playoff_table_kable_14_19()

```


## Win/Loss Point System
**1 point for regulation or OT win, 0 points for regulation or OT loss**

```{r, echo = FALSE, warning = FALSE, message = FALSE}
wild_card_14_19 %>%
    playoff_table_select(
        quo(points_win_loss),
        quo(playoff_win_loss),
        year_filter = "16_17") %>%
    playoff_table_kable_14_19()
```


## Discrepancies between the systems/ Do different point systems alter playoff teams?

```{r, echo = FALSE, warning = FALSE, message = FALSE}
discrepancies_df_14 %>%
    discrepancies_kable(year_in = "16_17", group_in = "div")

```

# 2015-2016 Playoff Standings

## 2 Point System (current NHL system)
**1 point for OT loss, 2 points for a regulation or OT win**

```{r, echo = FALSE, warning = FALSE, message = FALSE}
wild_card_14_19 %>%
    playoff_table_select(
        quo(points_2),
        quo(playoff_p2),
        quo(total_wins),
        year_filter = "15_16") %>%
    playoff_table_kable_14_19()

```

## 3 Point System
**1 point for OT loss, 2 point for OT win, 3 points for regulation win**

```{r, echo = FALSE, warning = FALSE, message = FALSE}

wild_card_14_19 %>%
    playoff_table_select(
        quo(points_3),
        quo(playoff_p3),
        year_filter = "15_16") %>%
    playoff_table_kable_14_19()

```


## Win/Loss Point System
**1 point for regulation or OT win, 0 points for regulation or OT loss**

```{r, echo = FALSE, warning = FALSE, message = FALSE}
wild_card_14_19 %>%
    playoff_table_select(
        quo(points_win_loss),
        quo(playoff_win_loss),
        year_filter = "15_16") %>%
    playoff_table_kable_14_19()
```


## Discrepancies between the systems/ Do different point systems alter playoff teams?

```{r, echo = FALSE, warning = FALSE, message = FALSE}
discrepancies_df_14 %>%
    discrepancies_kable(year_in = "15_16", group_in = "div")

```


# 2014-2015 Playoff Standings

## 2 Point System (current NHL system)
**1 point for OT loss, 2 points for a regulation or OT win**

```{r, echo = FALSE, warning = FALSE, message = FALSE}
wild_card_14_19 %>%
    playoff_table_select(
        quo(points_2),
        quo(playoff_p2),
        quo(total_wins),
        year_filter = "14_15") %>%
    playoff_table_kable_14_19()

```

## 3 Point System
**1 point for OT loss, 2 point for OT win, 3 points for regulation win**

```{r, echo = FALSE, warning = FALSE, message = FALSE}

wild_card_14_19 %>%
    playoff_table_select(
        quo(points_3),
        quo(playoff_p3),
        year_filter = "14_15") %>%
    playoff_table_kable_14_19()

```


## Win/Loss Point System
**1 point for regulation or OT win, 0 points for regulation or OT loss**

```{r, echo = FALSE, warning = FALSE, message = FALSE}
wild_card_14_19 %>%
    playoff_table_select(
        quo(points_win_loss),
        quo(playoff_win_loss),
        year_filter = "14_15") %>%
    playoff_table_kable_14_19()
```


## Discrepancies between the systems/ Do different point systems alter playoff teams?

```{r, echo = FALSE, warning = FALSE, message = FALSE}
discrepancies_df_14 %>%
    discrepancies_kable(year_in = "14_15", group_in = "div")

```

# 2013-2014 Playoff Standings

## 2 Point System (current NHL system)
**1 point for OT loss, 2 points for a regulation or OT win**

```{r, echo = FALSE, warning = FALSE, message = FALSE}
wild_card_14_19 %>%
    playoff_table_select(
        quo(points_2),
        quo(playoff_p2),
        quo(total_wins),
        year_filter = "13_14") %>%
    playoff_table_kable_14_19()

```

## 3 Point System
**1 point for OT loss, 2 point for OT win, 3 points for regulation win**

```{r, echo = FALSE, warning = FALSE, message = FALSE}

wild_card_14_19 %>%
    playoff_table_select(
        quo(points_3),
        quo(playoff_p3),
        year_filter = "13_14") %>%
    playoff_table_kable_14_19()

```


## Win/Loss Point System
**1 point for regulation or OT win, 0 points for regulation or OT loss**

```{r, echo = FALSE, warning = FALSE, message = FALSE}
wild_card_14_19 %>%
    playoff_table_select(
        quo(points_win_loss),
        quo(playoff_win_loss),
        year_filter = "13_14") %>%
    playoff_table_kable_14_19()
```


## Discrepancies between the systems/ Do different point systems alter playoff teams?

```{r, echo = FALSE, warning = FALSE, message = FALSE}
discrepancies_df_14 %>%
    discrepancies_kable(year_in = "13_14", group_in = "div")

```

# 2013-2006 Standings

Playoff seeding was decided by awarding a spot to the winner of each of the six divisions <br>
and the remaining spots to the top 5 remaining teams in each conference.

```{r, echo = FALSE, warning = FALSE, message = FALSE}
#build function for playoff seeding 2014 - 2019
#top three in each division then two wildcards
set_2005_2013_div_seeding <- function(df_in) {
    div_winners_out <- df_in %>%
        filter(
            group_level == "div" &
            (year == "12_13" |
            year == "11_12" |
            year == "10_11" |
            year == "09_10" |
            year == "08_09" |
            year == "07_08" |
            year == "06_07" |
            year == "05_06")
        ) %>%
        drop_na() %>%
        group_by(
            group,
            year) %>%
        mutate(
            div_order_p2 = order(
                order(
                    points_2,
                    total_wins,
                    decreasing = TRUE)),
            div_order_p3 = order(
                order(
                    points_3,
                    wins,
                    decreasing = TRUE)),
            div_order_win_loss = order(
                order(
                    points_win_loss,
                    wins,
                    decreasing = TRUE)),
            playoff_p2 = if_else(div_order_p2 == 1, "yes", "no"),
            playoff_p3 = if_else(div_order_p3 == 1, "yes", "no"),
            playoff_win_loss = if_else(div_order_win_loss == 1, "yes", "no"),
        ) %>%
        ungroup()
    return(div_winners_out)
}

set_2005_2013_conf_seeding <- function(df_in,
                                       filter_col,
                                       points_col,
                                       wins_col) {
    div_winners_out <- df_in %>%
        filter(
            group_level == "conf" &
            !!filter_col == "no" &
            (year == "12_13" |
            year == "11_12" |
            year == "10_11" |
            year == "09_10" |
            year == "08_09" |
            year == "07_08" |
            year == "06_07" |
            year == "05_06")
        ) %>%
        drop_na() %>%
        group_by(
            group,
            year
        ) %>%
        mutate(
            conf_order = order(
                order(
                    !!points_col,
                    !!wins_col,
                    decreasing = TRUE)),
            playoff_col = if_else(conf_order <= 5, "yes", "no"),
        ) %>%
        ungroup()
    return(div_winners_out)
}


div_playoff_2005_13 <- set_2005_2013_div_seeding(merged_standings_points_div)

standings_2005_13_w_div_po <- merge(
    x = merged_standings_points_div,
    y = div_playoff_2005_13[, c(
        "Team",
        "year",
        "playoff_p2",
        "playoff_p3",
        "playoff_win_loss")],
    by = c("Team", "year"),
    all.x = TRUE)
#build function for playoff seeding 2019 - 2020


conf_p2_playoff_05_13 <- set_2005_2013_conf_seeding(
    standings_2005_13_w_div_po,
    quo(playoff_p2),
    quo(points_2),
    quo(total_wins)
)

conf_p3_playoff_05_13 <- set_2005_2013_conf_seeding(
    standings_2005_13_w_div_po,
    quo(playoff_p3),
    quo(points_3),
    quo(wins)
)

conf_wl_playoff_05_13 <- set_2005_2013_conf_seeding(
    standings_2005_13_w_div_po,
    quo(playoff_win_loss),
    quo(points_win_loss),
    quo(wins)
)

div_p2_playoff_05_13 <- div_playoff_2005_13 %>%
    filter(playoff_p2 == "yes") %>%
    select(
        Team,
        year,
        playoff_p2
    )

div_p3_playoff_05_13 <- div_playoff_2005_13 %>%
    filter(playoff_p3 == "yes") %>%
    select(
        Team,
        year,
        playoff_p3
    )

div_wl_playoff_05_13 <- div_playoff_2005_13 %>%
    filter(playoff_win_loss == "yes") %>%
    select(
        Team,
        year,
        playoff_win_loss
    )

conf_p2_playoff_05_13 <- conf_p2_playoff_05_13 %>%
    select(
        Team,
        year,
        playoff_col
    ) %>%
    rename(
        playoff_p2 = playoff_col
    )

conf_p3_playoff_05_13 <- conf_p3_playoff_05_13 %>%
    select(
        Team,
        year,
        playoff_col
    ) %>%
    rename(
        playoff_p3 = playoff_col
    )

conf_wl_playoff_05_13 <- conf_wl_playoff_05_13 %>%
    select(
        Team,
        year,
        playoff_col
    ) %>%
    rename(
        playoff_win_loss = playoff_col
    )

standings_p2_05_13 <- rbind(div_p2_playoff_05_13, conf_p2_playoff_05_13)
standings_p3_05_13 <- rbind(div_p3_playoff_05_13, conf_p3_playoff_05_13)
standings_wl_05_13 <- rbind(div_wl_playoff_05_13, conf_wl_playoff_05_13)

standings_05_13 <- merge(merged_standings_points_div, standings_p2_05_13, by = c("Team", "year"))
standings_05_13 <- merge(standings_05_13, standings_p3_05_13, by = c("Team", "year"))
standings_05_13 <- merge(standings_05_13, standings_wl_05_13, by = c("Team", "year"))

playoff_table_kable_05_13 <- function(df_in) {
    pacific_count <- get_div_team_count(df_in, "Pacific")
    northwest_count <- get_div_team_count(df_in, "Northwest")
    southeast_count <- get_div_team_count(df_in, "Southeast")
    northeast_count <- get_div_team_count(df_in, "Northeast")
    atlantic_count <- get_div_team_count(df_in, "Atlantic")
    central_count <- get_div_team_count(df_in, "Central")

    playoff_yes <- which(df_in[["Playoff Birth Earned"]] == "yes")

    df_in %>%
        kable() %>%
        row_spec(playoff_yes, bold = TRUE) %>%
        kable_styling(
            bootstrap_options = c(
                "striped",
                "hover",
                "responsive"),
                fixed_thead = T) %>%
        pack_rows(
            index = c(
                "Atlantic" = atlantic_count,
                "Central" = central_count,
                "Northeast" = northeast_count,
                "Northwest" = northwest_count,
                "Pacific" = pacific_count,
                "Southeast" = southeast_count
                ))
}

```


# 2012-2013 Playoff Standings

## 2 Point System (current NHL system)
**1 point for OT loss, 2 points for a regulation or OT win**

```{r, echo = FALSE, warning = FALSE, message = FALSE}
standings_05_13 %>%
    playoff_table_select(
        quo(points_2),
        quo(playoff_p2),
        quo(total_wins),
        year_filter = "12_13") %>%
    playoff_table_kable_05_13()

```

## 3 Point System
**1 point for OT loss, 2 point for OT win, 3 points for regulation win**

```{r, echo = FALSE, warning = FALSE, message = FALSE}

standings_05_13 %>%
    playoff_table_select(
        quo(points_3),
        quo(playoff_p3),
        year_filter = "12_13") %>%
    playoff_table_kable_05_13()

```


## Win/Loss Point System
**1 point for regulation or OT win, 0 points for regulation or OT loss**

```{r, echo = FALSE, warning = FALSE, message = FALSE}
standings_05_13 %>%
    playoff_table_select(
        quo(points_win_loss),
        quo(playoff_win_loss),
        year_filter = "12_13") %>%
    playoff_table_kable_05_13()
```


## Discrepancies between the systems/ Do different point systems alter playoff teams?

```{r, echo = FALSE, warning = FALSE, message = FALSE}
discrepancies_df_05 <- find_playoff_changes(standings_05_13) %>%
    filter(group_level == "div")

discrepancies_df_05 %>%
    discrepancies_kable(year_in = "12_13", group_in = "div")

```

# 2011-2012 Playoff Standings

## 2 Point System (current NHL system)
**1 point for OT loss, 2 points for a regulation or OT win**

```{r, echo = FALSE, warning = FALSE, message = FALSE}
standings_05_13 %>%
    playoff_table_select(
        quo(points_2),
        quo(playoff_p2),
        quo(total_wins),
        year_filter = "11_12") %>%
    playoff_table_kable_05_13()

```

## 3 Point System
**1 point for OT loss, 2 point for OT win, 3 points for regulation win**

```{r, echo = FALSE, warning = FALSE, message = FALSE}

standings_05_13 %>%
    playoff_table_select(
        quo(points_3),
        quo(playoff_p3),
        year_filter = "11_12") %>%
    playoff_table_kable_05_13()

```


## Win/Loss Point System
**1 point for regulation or OT win, 0 points for regulation or OT loss**

```{r, echo = FALSE, warning = FALSE, message = FALSE}
standings_05_13 %>%
    playoff_table_select(
        quo(points_win_loss),
        quo(playoff_win_loss),
        year_filter = "11_12") %>%
    playoff_table_kable_05_13()
```


## Discrepancies between the systems/ Do different point systems alter playoff teams?

```{r, echo = FALSE, warning = FALSE, message = FALSE}
discrepancies_df_05 %>%
    discrepancies_kable(year_in = "11_12", group_in = "div")

```

# 2010-2011 Playoff Standings

## 2 Point System (current NHL system)
**1 point for OT loss, 2 points for a regulation or OT win**

```{r, echo = FALSE, warning = FALSE, message = FALSE}
standings_05_13 %>%
    playoff_table_select(
        quo(points_2),
        quo(playoff_p2),
        quo(total_wins),
        year_filter = "10_11") %>%
    playoff_table_kable_05_13()

```

## 3 Point System
**1 point for OT loss, 2 point for OT win, 3 points for regulation win**

```{r, echo = FALSE, warning = FALSE, message = FALSE}

standings_05_13 %>%
    playoff_table_select(
        quo(points_3),
        quo(playoff_p3),
        year_filter = "10_11") %>%
    playoff_table_kable_05_13()

```


## Win/Loss Point System
**1 point for regulation or OT win, 0 points for regulation or OT loss**

```{r, echo = FALSE, warning = FALSE, message = FALSE}
standings_05_13 %>%
    playoff_table_select(
        quo(points_win_loss),
        quo(playoff_win_loss),
        year_filter = "10_11") %>%
    playoff_table_kable_05_13()
```


## Discrepancies between the systems/ Do different point systems alter playoff teams?

```{r, echo = FALSE, warning = FALSE, message = FALSE}
discrepancies_df_05 %>%
    discrepancies_kable(year_in = "10_11", group_in = "div")

```

# 2009-2010 Playoff Standings

## 2 Point System (current NHL system)
**1 point for OT loss, 2 points for a regulation or OT win**

```{r, echo = FALSE, warning = FALSE, message = FALSE}
standings_05_13 %>%
    playoff_table_select(
        quo(points_2),
        quo(playoff_p2),
        quo(total_wins),
        year_filter = "09_10") %>%
    playoff_table_kable_05_13()

```

## 3 Point System
**1 point for OT loss, 2 point for OT win, 3 points for regulation win**

```{r, echo = FALSE, warning = FALSE, message = FALSE}

standings_05_13 %>%
    playoff_table_select(
        quo(points_3),
        quo(playoff_p3),
        year_filter = "09_10") %>%
    playoff_table_kable_05_13()

```


## Win/Loss Point System
**1 point for regulation or OT win, 0 points for regulation or OT loss**

```{r, echo = FALSE, warning = FALSE, message = FALSE}
standings_05_13 %>%
    playoff_table_select(
        quo(points_win_loss),
        quo(playoff_win_loss),
        year_filter = "09_10") %>%
    playoff_table_kable_05_13()
```


## Discrepancies between the systems/ Do different point systems alter playoff teams?

```{r, echo = FALSE, warning = FALSE, message = FALSE}
discrepancies_df_05 %>%
    discrepancies_kable(year_in = "09_10", group_in = "div")
 
```

# 2008-2009 Playoff Standings

## 2 Point System (current NHL system)
**1 point for OT loss, 2 points for a regulation or OT win**

```{r, echo = FALSE, warning = FALSE, message = FALSE}
standings_05_13 %>%
    playoff_table_select(
        quo(points_2),
        quo(playoff_p2),
        quo(total_wins),
        year_filter = "08_09") %>%
    playoff_table_kable_05_13()

```

## 3 Point System
**1 point for OT loss, 2 point for OT win, 3 points for regulation win**

```{r, echo = FALSE, warning = FALSE, message = FALSE}

standings_05_13 %>%
    playoff_table_select(
        quo(points_3),
        quo(playoff_p3),
        year_filter = "08_09") %>%
    playoff_table_kable_05_13()

```


## Win/Loss Point System
**1 point for regulation or OT win, 0 points for regulation or OT loss**

```{r, echo = FALSE, warning = FALSE, message = FALSE}
standings_05_13 %>%
    playoff_table_select(
        quo(points_win_loss),
        quo(playoff_win_loss),
        year_filter = "08_09") %>%
    playoff_table_kable_05_13()
```


**Discrepancies between the systems/ Do different point systems alter playoff teams?**

```{r, echo = FALSE, warning = FALSE, message = FALSE}
discrepancies_df_05 %>%
    discrepancies_kable(year_in = "09_08", group_in = "div")

```

# 2007-2008 Playoff Standings

## 2 Point System (current NHL system)
**1 point for OT loss, 2 points for a regulation or OT win**

```{r, echo = FALSE, warning = FALSE, message = FALSE}
standings_05_13 %>%
    playoff_table_select(
        quo(points_2),
        quo(playoff_p2),
        quo(total_wins),
        year_filter = "07_08") %>%
    playoff_table_kable_05_13()

```

## 3 Point System
**1 point for OT loss, 2 point for OT win, 3 points for regulation win**

```{r, echo = FALSE, warning = FALSE, message = FALSE}

standings_05_13 %>%
    playoff_table_select(
        quo(points_3),
        quo(playoff_p3),
        year_filter = "07_08") %>%
    playoff_table_kable_05_13()

```


## Win/Loss Point System
**1 point for regulation or OT win, 0 points for regulation or OT loss**

```{r, echo = FALSE, warning = FALSE, message = FALSE}
standings_05_13 %>%
    playoff_table_select(
        quo(points_win_loss),
        quo(playoff_win_loss),
        year_filter = "07_08") %>%
    playoff_table_kable_05_13()
```


## Discrepancies between the systems/ Do different point systems alter playoff teams?

```{r, echo = FALSE, warning = FALSE, message = FALSE}
discrepancies_df_05 %>%
    discrepancies_kable(year_in = "07_08", group_in = "div")

```

# 2006-2007 Playoff Standings
## 2 Point System (current NHL system)
**1 point for OT loss, 2 points for a regulation or OT win**

```{r, echo = FALSE, warning = FALSE, message = FALSE}
standings_05_13 %>%
    playoff_table_select(
        quo(points_2),
        quo(playoff_p2),
        quo(total_wins),
        year_filter = "06_07") %>%
    playoff_table_kable_05_13()

```

## 3 Point System
**1 point for OT loss, 2 point for OT win, 3 points for regulation win**

```{r, echo = FALSE, warning = FALSE, message = FALSE}

standings_05_13 %>%
    playoff_table_select(
        quo(points_3),
        quo(playoff_p3),
        year_filter = "06_07") %>%
    playoff_table_kable_05_13()

```


## Win/Loss Point System
**1 point for regulation or OT win, 0 points for regulation or OT loss**

```{r, echo = FALSE, warning = FALSE, message = FALSE}
standings_05_13 %>%
    playoff_table_select(
        quo(points_win_loss),
        quo(playoff_win_loss),
        year_filter = "06_07") %>%
    playoff_table_kable_05_13()
```


## Discrepancies between the systems/ Do different point systems alter playoff teams?

```{r, echo = FALSE, warning = FALSE, message = FALSE}
discrepancies_df_05 %>%
    discrepancies_kable(year_in = "06_07", group_in = "div")

```

# 2005-2006 Playoff Standings

## 2 Point System (current NHL system)
**1 point for OT loss, 2 points for a regulation or OT win**

```{r, echo = FALSE, warning = FALSE, message = FALSE}
standings_05_13 %>%
    playoff_table_select(
        quo(points_2),
        quo(playoff_p2),
        quo(total_wins),
        year_filter = "05_06") %>%
    playoff_table_kable_05_13()

```

## 3 Point System
**1 point for OT loss, 2 point for OT win, 3 points for regulation win**

```{r, echo = FALSE, warning = FALSE, message = FALSE}

standings_05_13 %>%
    playoff_table_select(
        quo(points_3),
        quo(playoff_p3),
        year_filter = "05_06") %>%
    playoff_table_kable_05_13()

```


## Win/Loss Point System
**1 point for regulation or OT win, 0 points for regulation or OT loss**

```{r, echo = FALSE, warning = FALSE, message = FALSE}
standings_05_13 %>%
    playoff_table_select(
        quo(points_win_loss),
        quo(playoff_win_loss),
        year_filter = "05_06") %>%
    playoff_table_kable_05_13()
```


## Discrepancies between the systems/ Do different point systems alter playoff teams?

```{r, echo = FALSE, warning = FALSE, message = FALSE}

discrepancies_df_05 %>%
   discrepancies_kable(year_in = "05_06", group_in = "div")

```


```{r all_discrepancy_table, echo = FALSE, warning = FALSE, message = FALSE}
discrepancies_kable_all <- function(discrepancies_df) {
    discrepancies_df %>%
        select(
            year,
            Team,
            group,
            wins,
            losses,
            ot_losses,
            ot_wins,
            total_wins,
            points_2,
            points_3,
            points_win_loss,
            playoff_p2,
            playoff_p3,
            playoff_win_loss,
            point_percent_2,
            point_percent_3,
            point_percent_wl,
            playoff_pp2,
            playoff_pp3,
            playoff_ppwl
        ) %>%
        rename(
            Year = year,
            Division = group,
            Wins = wins,
            Losses = losses,
            "OT Losses" = ot_losses,
            "OT Wins" = ot_wins,
            "Total Wins" = total_wins,
            "2 Point System Point Total" = points_2,
            "3 Point System Point Total" = points_3,
            "Win/Loss Point System Point Total" = points_win_loss,
            "Playoff Birth 2 Point System" = playoff_p2,
            "Playoff Birth 3 Point System" = playoff_p3,
            "Playoff Birth Win/Loss Point System" = playoff_win_loss,
            "3 Point System Point %" = point_percent_3,
            "2 Point System Point %" = point_percent_2,
            "Win/Loss Point System Point %" = point_percent_wl,
            "Playoff Birth 2 Point Percent" = playoff_pp2,
            "Playoff Birth 3 Point Percent" = playoff_pp3,
            "Playoff Birth Win/Loss Point Percent" = playoff_ppwl
        ) %>%
        kable() %>%
        kable_styling(
            bootstrap_options = c(
                "striped",
                "hover",
                "responsive"),
            fixed_thead = T) %>%
        scroll_box(width = "1000px", height = "600px")
}

discrepancies_all <- bind_rows(
    discrepancies_df_20,
    discrepancies_df_19,
    discrepancies_df_14,
    discrepancies_df_05) %>%
    arrange(desc(year), Team)


```

# All the changes with a 3 point system.

```{r, echo = FALSE, warning = FALSE, message = FALSE}
discrepancies_3_point <- discrepancies_all %>%
    filter(
        playoff_p2 != playoff_p3 |
        playoff_pp2 != playoff_pp3
    )

discrepancies_3_point %>% discrepancies_kable_all()
```

# All the changes with a win/loss system.

```{r, echo = FALSE, warning = FALSE, message = FALSE}
discrepancies_wl_point <- discrepancies_all %>%
    filter(
        playoff_p2 != playoff_win_loss |
        playoff_pp2 != playoff_ppwl
    )

discrepancies_wl_point %>% discrepancies_kable_all()
```
